
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&lt;no title&gt; &#8212; Test Report</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/test.js"></script>
    <script src="../_static/ngl.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. TEST" href="../there_test.html" />
    <link rel="prev" title="1.2. Interactive exploration" href="ed6dd3148ef9b069_GaMD_interactive.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Test Report</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="intro_22.html">
   1. Compound 22
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ed6dd3148ef9b069_GaMD_processed.html">
     1.1. Analysis Notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ed6dd3148ef9b069_GaMD_interactive.html">
     1.2. Interactive exploration
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../there_test.html">
   2. TEST
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/22/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/d-cru/test_report"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/d-cru/test_report/issues/new?title=Issue%20on%20page%20%2F22/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/d-cru/test_report/main?urlpath=tree/test_report/22/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell tag_snakemake-job-properties docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## snakemake preamble start (automatically inserted, do not edit) ########</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;/biggin/b147/univ4859/miniconda3/envs/snakemake/lib/python3.9/site-packages&#39;</span><span class="p">,</span> <span class="s1">&#39;/biggin/b147/univ4859/research/03_macroconf/notebooks&#39;</span><span class="p">]);</span> <span class="kn">import</span> <span class="nn">pickle</span><span class="p">;</span> <span class="n">snakemake</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x80\x04\x95\x8e</span><span class="s1">,</span><span class="se">\x00\x00\x00\x00\x00\x00\x8c\x10</span><span class="s1">snakemake.script</span><span class="se">\x94\x8c\t</span><span class="s1">Snakemake</span><span class="se">\x94\x93\x94</span><span class="s1">)</span><span class="se">\x81\x94</span><span class="s1">}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x05</span><span class="s1">input</span><span class="se">\x94\x8c\x0c</span><span class="s1">snakemake.io</span><span class="se">\x94\x8c\n</span><span class="s1">InputFiles</span><span class="se">\x94\x93\x94</span><span class="s1">)</span><span class="se">\x81\x94</span><span class="s1">(</span><span class="se">\x8c</span><span class="s1">&amp;data/interim/refactor-test/22/NOE.json</span><span class="se">\x94\x8c\&#39;</span><span class="s1">data/interim/refactor-test/22/data.json</span><span class="se">\x94\x8c</span><span class="s1">Rdata/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_weights.dat</span><span class="se">\x94\x8c</span><span class="s1">Mdata/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_md.out</span><span class="se">\x94\x8c</span><span class="s1">Rdata/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_traj.netcdf</span><span class="se">\x94\x8c</span><span class="s1">Pdata/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_traj.ncdf</span><span class="se">\x94\x8c</span><span class="s1">^data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_clusters/clusters.pdb</span><span class="se">\x94\x8c</span><span class="s1">?data/interim/refactor-test/22/H2O/1_make_topology/mc_sol.prmtop</span><span class="se">\x94\x8c</span><span class="s1">1data/interim/refactor-test/22/omega/basic/mcs.pdb</span><span class="se">\x94\x8c</span><span class="s1">Vdata/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_dihedrals.dat</span><span class="se">\x94\x8c</span><span class="s1">Qdata/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_dPCA.dat</span><span class="se">\x94\x8c\\</span><span class="s1">data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_dPCA_weights_MC.dat</span><span class="se">\x94\x8c</span><span class="s1">Udata/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_NOE_dist.dat</span><span class="se">\x94\x8c</span><span class="s1">Udata/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_multiple.dat</span><span class="se">\x94\x8c</span><span class="s1">Rdata/interim/refactor-test/22/H2O/11_GaMD_full/1000/0/8374da5ea9cc35c0_weights.dat</span><span class="se">\x94\x8c</span><span class="s1">Mdata/interim/refactor-test/22/H2O/11_GaMD_full/1000/0/8374da5ea9cc35c0_md.out</span><span class="se">\x94\x8c</span><span class="s1">Rdata/interim/refactor-test/22/H2O/11_GaMD_full/1000/0/8374da5ea9cc35c0_traj.netcdf</span><span class="se">\x94\x8c</span><span class="s1">Pdata/interim/refactor-test/22/H2O/11_GaMD_full/1000/0/8374da5ea9cc35c0_traj.ncdf</span><span class="se">\x94\x8c</span><span class="s1">^data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_clusters/clusters.pdb</span><span class="se">\x94\x8c</span><span class="s1">?data/interim/refactor-test/22/H2O/1_make_topology/mc_sol.prmtop</span><span class="se">\x94\x8c</span><span class="s1">Vdata/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_dihedrals.dat</span><span class="se">\x94\x8c</span><span class="s1">Qdata/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_dPCA.dat</span><span class="se">\x94\x8c\\</span><span class="s1">data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_dPCA_weights_MC.dat</span><span class="se">\x94\x8c</span><span class="s1">Udata/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_NOE_dist.dat</span><span class="se">\x94\x8c</span><span class="s1">Udata/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_multiple.dat</span><span class="se">\x94\x8c</span><span class="s1">Ydata/interim/refactor-test/22/Chloroform/11_GaMD_full/1000/0/d236cb661a6d3813_weights.dat</span><span class="se">\x94\x8c</span><span class="s1">Tdata/interim/refactor-test/22/Chloroform/11_GaMD_full/1000/0/d236cb661a6d3813_md.out</span><span class="se">\x94\x8c</span><span class="s1">Ydata/interim/refactor-test/22/Chloroform/11_GaMD_full/1000/0/d236cb661a6d3813_traj.netcdf</span><span class="se">\x94\x8c</span><span class="s1">Wdata/interim/refactor-test/22/Chloroform/11_GaMD_full/1000/0/d236cb661a6d3813_traj.ncdf</span><span class="se">\x94\x8c</span><span class="s1">edata/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_clusters/clusters.pdb</span><span class="se">\x94\x8c</span><span class="s1">Fdata/interim/refactor-test/22/Chloroform/1_make_topology/mc_sol.prmtop</span><span class="se">\x94\x8c</span><span class="s1">]data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_dihedrals.dat</span><span class="se">\x94\x8c</span><span class="s1">Xdata/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_dPCA.dat</span><span class="se">\x94\x8c</span><span class="s1">cdata/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_dPCA_weights_MC.dat</span><span class="se">\x94\x8c\\</span><span class="s1">data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_NOE_dist.dat</span><span class="se">\x94\x8c\\</span><span class="s1">data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_multiple.dat</span><span class="se">\x94</span><span class="s1">e}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x06</span><span class="s1">_names</span><span class="se">\x94</span><span class="s1">}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x03</span><span class="s1">noe</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x00</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x04</span><span class="s1">parm</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x01</span><span class="s1">N</span><span class="se">\x86\x94\x8c\t</span><span class="s1">weights_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x02</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x05</span><span class="s1">out_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x03</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x06</span><span class="s1">traj_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x04</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x0b</span><span class="s1">traj_ncdf_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x05</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">clusters_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x06</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x05</span><span class="s1">top_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x07</span><span class="s1">N</span><span class="se">\x86\x94\x8c\r</span><span class="s1">cheminfoconfs</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x08</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">red_dihe_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\t</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x06</span><span class="s1">dPCA_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x11</span><span class="s1">dPCA_weights_MC_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0b</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">NOE_dist_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0c</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">multiple_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\r</span><span class="s1">N</span><span class="se">\x86\x94\x8c\t</span><span class="s1">weights_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0e</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x05</span><span class="s1">out_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0f</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x06</span><span class="s1">traj_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x10</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x0b</span><span class="s1">traj_ncdf_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x11</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">clusters_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x12</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x05</span><span class="s1">top_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x13</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">red_dihe_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x14</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x06</span><span class="s1">dPCA_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x15</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x11</span><span class="s1">dPCA_weights_MC_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x16</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">NOE_dist_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x17</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">multiple_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x18</span><span class="s1">N</span><span class="se">\x86\x94\x8c\t</span><span class="s1">weights_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x19</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x05</span><span class="s1">out_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x1a</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x06</span><span class="s1">traj_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x1b</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x0b</span><span class="s1">traj_ncdf_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x1c</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">clusters_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x1d</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x05</span><span class="s1">top_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x1e</span><span class="s1">N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">red_dihe_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x1f</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x06</span><span class="s1">dPCA_2</span><span class="se">\x94</span><span class="s1">K N</span><span class="se">\x86\x94\x8c\x11</span><span class="s1">dPCA_weights_MC_2</span><span class="se">\x94</span><span class="s1">K!N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">NOE_dist_2</span><span class="se">\x94</span><span class="s1">K&quot;N</span><span class="se">\x86\x94\x8c\n</span><span class="s1">multiple_2</span><span class="se">\x94</span><span class="s1">K#N</span><span class="se">\x86\x94</span><span class="s1">u</span><span class="se">\x8c\x12</span><span class="s1">_allowed_overrides</span><span class="se">\x94</span><span class="s1">]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x05</span><span class="s1">index</span><span class="se">\x94\x8c\x04</span><span class="s1">sort</span><span class="se">\x94</span><span class="s1">eh{</span><span class="se">\x8c\t</span><span class="s1">functools</span><span class="se">\x94\x8c\x07</span><span class="s1">partial</span><span class="se">\x94\x93\x94</span><span class="s1">h</span><span class="se">\x06\x8c\x19</span><span class="s1">Namedlist._used_attribute</span><span class="se">\x94\x93\x94\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94\x8c\x05</span><span class="s1">_name</span><span class="se">\x94</span><span class="s1">h{sNt</span><span class="se">\x94</span><span class="s1">bh|h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h|sNt</span><span class="se">\x94</span><span class="s1">bh1h</span><span class="se">\n</span><span class="s1">h3h</span><span class="se">\x0b\x8c\t</span><span class="s1">weights_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x0c\x8c\x05</span><span class="s1">out_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\r\x8c\x06</span><span class="s1">traj_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x0e\x8c\x0b</span><span class="s1">traj_ncdf_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x0f\x8c\n</span><span class="s1">clusters_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x10\x8c\x05</span><span class="s1">top_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x11</span><span class="s1">hAh</span><span class="se">\x12\x8c\n</span><span class="s1">red_dihe_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x13\x8c\x06</span><span class="s1">dPCA_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x14\x8c\x11</span><span class="s1">dPCA_weights_MC_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x15\x8c\n</span><span class="s1">NOE_dist_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x16\x8c\n</span><span class="s1">multiple_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x17\x8c\t</span><span class="s1">weights_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x18\x8c\x05</span><span class="s1">out_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x19\x8c\x06</span><span class="s1">traj_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x1a\x8c\x0b</span><span class="s1">traj_ncdf_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x1b\x8c\n</span><span class="s1">clusters_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x1c\x8c\x05</span><span class="s1">top_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x1d\x8c\n</span><span class="s1">red_dihe_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x1e\x8c\x06</span><span class="s1">dPCA_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x1f\x8c\x11</span><span class="s1">dPCA_weights_MC_1</span><span class="se">\x94</span><span class="s1">h </span><span class="se">\x8c\n</span><span class="s1">NOE_dist_1</span><span class="se">\x94</span><span class="s1">h!</span><span class="se">\x8c\n</span><span class="s1">multiple_1</span><span class="se">\x94</span><span class="s1">h&quot;</span><span class="se">\x8c\t</span><span class="s1">weights_2</span><span class="se">\x94</span><span class="s1">h#</span><span class="se">\x8c\x05</span><span class="s1">out_2</span><span class="se">\x94</span><span class="s1">h$</span><span class="se">\x8c\x06</span><span class="s1">traj_2</span><span class="se">\x94</span><span class="s1">h%</span><span class="se">\x8c\x0b</span><span class="s1">traj_ncdf_2</span><span class="se">\x94</span><span class="s1">h&amp;</span><span class="se">\x8c\n</span><span class="s1">clusters_2</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\&#39;\x8c\x05</span><span class="s1">top_2</span><span class="se">\x94</span><span class="s1">h(</span><span class="se">\x8c\n</span><span class="s1">red_dihe_2</span><span class="se">\x94</span><span class="s1">h)</span><span class="se">\x8c\x06</span><span class="s1">dPCA_2</span><span class="se">\x94</span><span class="s1">h*</span><span class="se">\x8c\x11</span><span class="s1">dPCA_weights_MC_2</span><span class="se">\x94</span><span class="s1">h+</span><span class="se">\x8c\n</span><span class="s1">NOE_dist_2</span><span class="se">\x94</span><span class="s1">h,</span><span class="se">\x8c\n</span><span class="s1">multiple_2</span><span class="se">\x94</span><span class="s1">h-ub</span><span class="se">\x8c\x06</span><span class="s1">output</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x06\x8c\x0b</span><span class="s1">OutputFiles</span><span class="se">\x94\x93\x94</span><span class="s1">)</span><span class="se">\x81\x94</span><span class="s1">(</span><span class="se">\x8c</span><span class="s1">~data/processed/refactor-test/results/22/comparison/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic-pca_dihe.png</span><span class="se">\x94\x8c\x81</span><span class="s1">data/processed/refactor-test/results/22/comparison/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic-cluster-pca.png</span><span class="se">\x94</span><span class="s1">e}</span><span class="se">\x94</span><span class="s1">(h/}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x08</span><span class="s1">pca_dihe</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x00</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x0b</span><span class="s1">cluster_pca</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x01</span><span class="s1">N</span><span class="se">\x86\x94</span><span class="s1">uhy]</span><span class="se">\x94</span><span class="s1">(h{h|eh{h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h{sNt</span><span class="se">\x94</span><span class="s1">bh|h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h|sNt</span><span class="se">\x94</span><span class="s1">bh</span><span class="se">\xb4</span><span class="s1">h</span><span class="se">\xb0</span><span class="s1">h</span><span class="se">\xb6</span><span class="s1">h</span><span class="se">\xb1</span><span class="s1">ub</span><span class="se">\x8c\x06</span><span class="s1">params</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x06\x8c\x06</span><span class="s1">Params</span><span class="se">\x94\x93\x94</span><span class="s1">)</span><span class="se">\x81\x94</span><span class="s1">(}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x08</span><span class="s1">compound</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x06</span><span class="s1">method</span><span class="se">\x94\x8c\x04</span><span class="s1">GaMD</span><span class="se">\x94\x8c\x07</span><span class="s1">solvent</span><span class="se">\x94\x8c\x03</span><span class="s1">H2O</span><span class="se">\x94\x8c\x07</span><span class="s1">simtime</span><span class="se">\x94\x8c\x04</span><span class="s1">2000</span><span class="se">\x94\x8c\x02</span><span class="s1">dt</span><span class="se">\x94\x8c\x05</span><span class="s1">0.002</span><span class="se">\x94\x8c\x07</span><span class="s1">repeats</span><span class="se">\x94\x8c\x01</span><span class="s1">0</span><span class="se">\x94\x8c\x0b</span><span class="s1">other_param</span><span class="se">\x94\x8c\x03</span><span class="s1">0.2</span><span class="se">\x94\x8c\x05</span><span class="s1">igamd</span><span class="se">\x94\x8c\x03</span><span class="s1">nan</span><span class="se">\x94\x8c\x06</span><span class="s1">nstlim</span><span class="se">\x94\x8c\n</span><span class="s1">1000000000</span><span class="se">\x94</span><span class="s1">u}</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\xc6\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xc8\x8c\x04</span><span class="s1">GaMD</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xca</span><span class="s1">h</span><span class="se">\xcb</span><span class="s1">h</span><span class="se">\xcc\x8c\x04</span><span class="s1">1000</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xce\x8c\x05</span><span class="s1">0.002</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xd0\x8c\x01</span><span class="s1">0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xd2</span><span class="s1">h</span><span class="se">\xd3</span><span class="s1">h</span><span class="se">\xd4\x8c\x03</span><span class="s1">nan</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xd6\x8c\t</span><span class="s1">500000000</span><span class="se">\x94</span><span class="s1">u}</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\xc6</span><span class="s1">h</span><span class="se">\xc7</span><span class="s1">h</span><span class="se">\xc8</span><span class="s1">h</span><span class="se">\xc9</span><span class="s1">h</span><span class="se">\xca\x8c\n</span><span class="s1">Chloroform</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xcc\x8c\x04</span><span class="s1">1000</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xce\x8c\x05</span><span class="s1">0.002</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xd0\x8c\x01</span><span class="s1">0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xd2</span><span class="s1">h</span><span class="se">\xd3</span><span class="s1">h</span><span class="se">\xd4\x8c\x01</span><span class="s1">1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xd6\x8c\t</span><span class="s1">500000000</span><span class="se">\x94</span><span class="s1">ue}</span><span class="se">\x94</span><span class="s1">(h/}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x08</span><span class="s1">sample_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x00</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x08</span><span class="s1">sample_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x01</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x08</span><span class="s1">sample_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x02</span><span class="s1">N</span><span class="se">\x86\x94</span><span class="s1">uhy]</span><span class="se">\x94</span><span class="s1">(h{h|eh{h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h{sNt</span><span class="se">\x94</span><span class="s1">bh|h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h|sNt</span><span class="se">\x94</span><span class="s1">bh</span><span class="se">\xe9</span><span class="s1">h</span><span class="se">\xc5</span><span class="s1">h</span><span class="se">\xeb</span><span class="s1">h</span><span class="se">\xd8</span><span class="s1">h</span><span class="se">\xed</span><span class="s1">h</span><span class="se">\xe0</span><span class="s1">ub</span><span class="se">\x8c\t</span><span class="s1">wildcards</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x06\x8c\t</span><span class="s1">Wildcards</span><span class="se">\x94\x93\x94</span><span class="s1">)</span><span class="se">\x81\x94</span><span class="s1">(</span><span class="se">\x8c\r</span><span class="s1">refactor-test</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">d236cb661a6d3813</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e}</span><span class="se">\x94</span><span class="s1">(h/}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x08</span><span class="s1">exp_name</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x00</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x0c</span><span class="s1">compound_dir</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x01</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x07</span><span class="s1">index_0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x02</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x07</span><span class="s1">index_1</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x03</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x07</span><span class="s1">index_2</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x04</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x07</span><span class="s1">confgen</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x05</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x04</span><span class="s1">mode</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x06</span><span class="s1">N</span><span class="se">\x86\x94</span><span class="s1">uhy]</span><span class="se">\x94</span><span class="s1">(h{h|eh{h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h{sNt</span><span class="se">\x94</span><span class="s1">bh|h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h|sNt</span><span class="se">\x94</span><span class="s1">b</span><span class="se">\x8c\x08</span><span class="s1">exp_name</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xfc\x8c\x0c</span><span class="s1">compound_dir</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xfd\x8c\x07</span><span class="s1">index_0</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xfe\x8c\x07</span><span class="s1">index_1</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\xff\x8c\x07</span><span class="s1">index_2</span><span class="se">\x94</span><span class="s1">j</span><span class="se">\x00\x01\x00\x00\x8c\x07</span><span class="s1">confgen</span><span class="se">\x94</span><span class="s1">j</span><span class="se">\x01\x01\x00\x00\x8c\x04</span><span class="s1">mode</span><span class="se">\x94</span><span class="s1">j</span><span class="se">\x02\x01\x00\x00</span><span class="s1">ub</span><span class="se">\x8c\x07</span><span class="s1">threads</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x04\x8c\t</span><span class="s1">resources</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x06\x8c\t</span><span class="s1">Resources</span><span class="se">\x94\x93\x94</span><span class="s1">)</span><span class="se">\x81\x94</span><span class="s1">(K</span><span class="se">\x04</span><span class="s1">K</span><span class="se">\x01\x8c\x04</span><span class="s1">/tmp</span><span class="se">\x94</span><span class="s1">e}</span><span class="se">\x94</span><span class="s1">(h/}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x06</span><span class="s1">_cores</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x00</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x06</span><span class="s1">_nodes</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x01</span><span class="s1">N</span><span class="se">\x86\x94\x8c\x06</span><span class="s1">tmpdir</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x02</span><span class="s1">N</span><span class="se">\x86\x94</span><span class="s1">uhy]</span><span class="se">\x94</span><span class="s1">(h{h|eh{h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h{sNt</span><span class="se">\x94</span><span class="s1">bh|h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h|sNt</span><span class="se">\x94</span><span class="s1">bj+</span><span class="se">\x01\x00\x00</span><span class="s1">K</span><span class="se">\x04</span><span class="s1">j-</span><span class="se">\x01\x00\x00</span><span class="s1">K</span><span class="se">\x01</span><span class="s1">j/</span><span class="se">\x01\x00\x00</span><span class="s1">j(</span><span class="se">\x01\x00\x00</span><span class="s1">ub</span><span class="se">\x8c\x03</span><span class="s1">log</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x06\x8c\x03</span><span class="s1">Log</span><span class="se">\x94\x93\x94</span><span class="s1">)</span><span class="se">\x81\x94\x8c</span><span class="s1">udata/processed/refactor-test/notebooks/22/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar.ipynb</span><span class="se">\x94</span><span class="s1">a}</span><span class="se">\x94</span><span class="s1">(h/}</span><span class="se">\x94\x8c\x08</span><span class="s1">notebook</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x00</span><span class="s1">N</span><span class="se">\x86\x94</span><span class="s1">shy]</span><span class="se">\x94</span><span class="s1">(h{h|eh{h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h{sNt</span><span class="se">\x94</span><span class="s1">bh|h</span><span class="se">\x7f</span><span class="s1">h</span><span class="se">\x81\x85\x94</span><span class="s1">R</span><span class="se">\x94</span><span class="s1">(h</span><span class="se">\x81</span><span class="s1">)}</span><span class="se">\x94</span><span class="s1">h</span><span class="se">\x85</span><span class="s1">h|sNt</span><span class="se">\x94</span><span class="s1">bjA</span><span class="se">\x01\x00\x00</span><span class="s1">j&gt;</span><span class="se">\x01\x00\x00</span><span class="s1">ub</span><span class="se">\x8c\x06</span><span class="s1">config</span><span class="se">\x94</span><span class="s1">}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\t</span><span class="s1">compounds</span><span class="se">\x94</span><span class="s1">]</span><span class="se">\x94</span><span class="s1">(K8K</span><span class="se">\x18</span><span class="s1">K</span><span class="se">\x16</span><span class="s1">K7e</span><span class="se">\x8c\x10</span><span class="s1">cheminfo_confgen</span><span class="se">\x94</span><span class="s1">]</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94</span><span class="s1">a</span><span class="se">\x8c\x11</span><span class="s1">confgen_paramters</span><span class="se">\x94</span><span class="s1">}</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94</span><span class="s1">]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x05</span><span class="s1">basic</span><span class="se">\x94\x8c\n</span><span class="s1">chloroform</span><span class="se">\x94</span><span class="s1">es</span><span class="se">\x8c\t</span><span class="s1">hash_list</span><span class="se">\x94</span><span class="s1">]</span><span class="se">\x94</span><span class="s1">(]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">94214a84a78d8392</span><span class="se">\x94\x8c\x10</span><span class="s1">ea902b72328019c4</span><span class="se">\x94\x8c\x10</span><span class="s1">05834cbd8c236ca0</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x01</span><span class="s1">0</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">f85eb31757da7e52</span><span class="se">\x94\x8c\x10</span><span class="s1">05834cbd8c236ca0</span><span class="se">\x94\x8c\x10</span><span class="s1">9eb48310b74aa061</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">10236f52ef18b2a3</span><span class="se">\x94\x8c\x10</span><span class="s1">15ff3a3813ba7460</span><span class="se">\x94\x8c\x10</span><span class="s1">e36fd3c2b58d633f</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">c530212023f40ad9</span><span class="se">\x94\x8c\x10</span><span class="s1">10236f52ef18b2a3</span><span class="se">\x94\x8c\x10</span><span class="s1">94214a84a78d8392</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">0a303e31ccdf82a5</span><span class="se">\x94\x8c\x10</span><span class="s1">c530212023f40ad9</span><span class="se">\x94\x8c\x10</span><span class="s1">10236f52ef18b2a3</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">0a303e31ccdf82a5</span><span class="se">\x94\x8c\x10</span><span class="s1">6223de6c169344e9</span><span class="se">\x94\x8c\x10</span><span class="s1">f85eb31757da7e52</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">0a303e31ccdf82a5</span><span class="se">\x94\x8c\x10</span><span class="s1">15ff3a3813ba7460</span><span class="se">\x94\x8c\x10</span><span class="s1">e36fd3c2b58d633f</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">6223de6c169344e9</span><span class="se">\x94\x8c\x10</span><span class="s1">f85eb31757da7e52</span><span class="se">\x94\x8c\x10</span><span class="s1">b3332ce08307c920</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">b3332ce08307c920</span><span class="se">\x94\x8c\x10</span><span class="s1">1f323341d36478d5</span><span class="se">\x94\x8c\x10</span><span class="s1">f8f83124ccdc7c13</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">e36fd3c2b58d633f</span><span class="se">\x94\x8c\x10</span><span class="s1">f8f83124ccdc7c13</span><span class="se">\x94\x8c\x10</span><span class="s1">282f14929802f7ac</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">0a303e31ccdf82a5</span><span class="se">\x94\x8c\x10</span><span class="s1">e36fd3c2b58d633f</span><span class="se">\x94\x8c\x10</span><span class="s1">f8f83124ccdc7c13</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">0a303e31ccdf82a5</span><span class="se">\x94\x8c\x10</span><span class="s1">9eb48310b74aa061</span><span class="se">\x94\x8c\x10</span><span class="s1">282f14929802f7ac</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">5ad86a1e5e790925</span><span class="se">\x94\x8c\x10</span><span class="s1">7e4cdc50cc70fc15</span><span class="se">\x94\x8c\x10</span><span class="s1">4574de591364a01f</span><span class="se">\x94\x8c\x02</span><span class="s1">55</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">5ad86a1e5e790925</span><span class="se">\x94\x8c\x10</span><span class="s1">395e86cd79c14300</span><span class="se">\x94\x8c\x10</span><span class="s1">938ec71731842389</span><span class="se">\x94\x8c\x02</span><span class="s1">55</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">0a303e31ccdf82a5</span><span class="se">\x94\x8c\x10</span><span class="s1">10236f52ef18b2a3</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">0a303e31ccdf82a5</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">c530212023f40ad9</span><span class="se">\x94\x8c\x10</span><span class="s1">10236f52ef18b2a3</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">3d00b0964201e088</span><span class="se">\x94\x8c\x10</span><span class="s1">09a11fd633f3a72b</span><span class="se">\x94\x8c\x10</span><span class="s1">6a9359deeeab1adc</span><span class="se">\x94\x8c\x02</span><span class="s1">24</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">3d00b0964201e088</span><span class="se">\x94\x8c\x10</span><span class="s1">5d7022b409750c68</span><span class="se">\x94\x8c\x10</span><span class="s1">e92cb0e6ed121828</span><span class="se">\x94\x8c\x02</span><span class="s1">24</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">242ee4d4af3634ed</span><span class="se">\x94\x8c\x10</span><span class="s1">660d1badff741862</span><span class="se">\x94\x8c\x10</span><span class="s1">5ad86a1e5e790925</span><span class="se">\x94\x8c\x02</span><span class="s1">55</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">3c523c7ca380f925</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">0a303e31ccdf82a5</span><span class="se">\x94\x8c\x10</span><span class="s1">3c523c7ca380f925</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">9a100624325ec4cd</span><span class="se">\x94\x8c\x10</span><span class="s1">9eb48310b74aa061</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">242ee4d4af3634ed</span><span class="se">\x94\x8c\x10</span><span class="s1">6163f1ecc9f26d15</span><span class="se">\x94\x8c\x10</span><span class="s1">938ec71731842389</span><span class="se">\x94\x8c\x02</span><span class="s1">55</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">db88602b153df078</span><span class="se">\x94\x8c\x10</span><span class="s1">c74338f1c2e97967</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">04326f349933814b</span><span class="se">\x94\x8c\x10</span><span class="s1">db88602b153df078</span><span class="se">\x94\x8c\x10</span><span class="s1">c74338f1c2e97967</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">bbe75067f45d5efd</span><span class="se">\x94\x8c\x10</span><span class="s1">9a100624325ec4cd</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">2088374558ed79c5</span><span class="se">\x94\x8c\x10</span><span class="s1">b269c69e29e2b3a6</span><span class="se">\x94\x8c\x10</span><span class="s1">d7cd9d09c7724d89</span><span class="se">\x94\x8c\x02</span><span class="s1">56</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">b42d1cec1349e562</span><span class="se">\x94\x8c\x10</span><span class="s1">3d110be4b2d63f96</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">1a8e577036845661</span><span class="se">\x94\x8c\x10</span><span class="s1">bbe75067f45d5efd</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">3d110be4b2d63f96</span><span class="se">\x94\x8c\x10</span><span class="s1">b42d1cec1349e562</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">3c523c7ca380f925</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">5eedf239922efaee</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">3d00b0964201e088</span><span class="se">\x94\x8c\x10</span><span class="s1">09a11fd633f3a72b</span><span class="se">\x94\x8c\x10</span><span class="s1">5d7022b409750c68</span><span class="se">\x94\x8c\x02</span><span class="s1">24</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">459a7f09ce68039a</span><span class="se">\x94\x8c\x10</span><span class="s1">3fe88b3d3ed6d9d3</span><span class="se">\x94\x8c\x10</span><span class="s1">d236cb661a6d3813</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">459a7f09ce68039a</span><span class="se">\x94\x8c\x10</span><span class="s1">1a8e577036845661</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">j`</span><span class="se">\x01\x00\x00</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">3c523c7ca380f925</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\n</span><span class="s1">chloroform</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">459a7f09ce68039a</span><span class="se">\x94\x8c\x10</span><span class="s1">d236cb661a6d3813</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\n</span><span class="s1">chloroform</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">d236cb661a6d3813</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x05</span><span class="s1">omega</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94\x8c\x10</span><span class="s1">3c523c7ca380f925</span><span class="se">\x94\x8c\x02</span><span class="s1">22</span><span class="se">\x94\x8c\x05</span><span class="s1">rdkit</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">3d00b0964201e088</span><span class="se">\x94\x8c\x10</span><span class="s1">09a11fd633f3a72b</span><span class="se">\x94\x8c\x10</span><span class="s1">5d7022b409750c68</span><span class="se">\x94\x8c\x02</span><span class="s1">24</span><span class="se">\x94\x8c\x05</span><span class="s1">rdkit</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">242ee4d4af3634ed</span><span class="se">\x94\x8c\x10</span><span class="s1">6163f1ecc9f26d15</span><span class="se">\x94\x8c\x10</span><span class="s1">938ec71731842389</span><span class="se">\x94\x8c\x02</span><span class="s1">55</span><span class="se">\x94\x8c\x05</span><span class="s1">rdkit</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">e]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">2088374558ed79c5</span><span class="se">\x94\x8c\x10</span><span class="s1">b269c69e29e2b3a6</span><span class="se">\x94\x8c\x10</span><span class="s1">d7cd9d09c7724d89</span><span class="se">\x94\x8c\x02</span><span class="s1">56</span><span class="se">\x94\x8c\x05</span><span class="s1">rdkit</span><span class="se">\x94\x8c\x05</span><span class="s1">basic</span><span class="se">\x94</span><span class="s1">ee</span><span class="se">\x8c\x06</span><span class="s1">stride</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n\x8c\x0c</span><span class="s1">cluster_conf</span><span class="se">\x94</span><span class="s1">}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x10</span><span class="s1">242ee4d4af3634ed</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0f\x8c\x10</span><span class="s1">8374da5ea9cc35c0</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n\x8c\x10</span><span class="s1">3c523c7ca380f925</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n\x8c\x10</span><span class="s1">ca1a37290d9e454e</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x08\x8c\x10</span><span class="s1">9a100624325ec4cd</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x06\x8c\x10</span><span class="s1">3d00b0964201e088</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n\x8c\x10</span><span class="s1">ed6dd3148ef9b069</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x08</span><span class="s1">u</span><span class="se">\x8c\x04</span><span class="s1">ns_h</span><span class="se">\x94</span><span class="s1">G@)</span><span class="se">\x00\x00\x00\x00\x00\x00\x8c\x08</span><span class="s1">exp_name</span><span class="se">\x94\x8c\r</span><span class="s1">refactor-test</span><span class="se">\x94\x8c\t</span><span class="s1">data_name</span><span class="se">\x94\x8c\x17</span><span class="s1">22-02-2021_MacroConf-v2</span><span class="se">\x94\x8c\x0b</span><span class="s1">sample_file</span><span class="se">\x94\x8c\x0b</span><span class="s1">samples.tsv</span><span class="se">\x94\x8c\r</span><span class="s1">sample_output</span><span class="se">\x94\x8c\x0f</span><span class="s1">samples_old.tsv</span><span class="se">\x94\x8c\n</span><span class="s1">forcefield</span><span class="se">\x94\x8c</span><span class="s1">1libs/forcefields/leaprc.protein.ff14SB_noterminal</span><span class="se">\x94\x8c\x0b</span><span class="s1">DMSO_params</span><span class="se">\x94\x8c</span><span class="s1">!libs/md_solvents/dmso/frcmod.dmso</span><span class="se">\x94\x8c\x08</span><span class="s1">DMSO_box</span><span class="se">\x94\x8c</span><span class="s1">!libs/md_solvents/dmso/dmsobox.off</span><span class="se">\x94\x8c\x11</span><span class="s1">Chloroform_params</span><span class="se">\x94\x8c\x0c</span><span class="s1">frcmod.chcl3</span><span class="se">\x94\x8c\x16</span><span class="s1">clustering_min_samples</span><span class="se">\x94</span><span class="s1">}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n</span><span class="s1">h</span><span class="se">\xe5</span><span class="s1">K&quot;u</span><span class="se">\x8c\x0e</span><span class="s1">aMD_clustering</span><span class="se">\x94</span><span class="s1">}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x02</span><span class="s1">56</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0c\x8c\x02</span><span class="s1">55</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x07</span><span class="s1">u</span><span class="se">\x8c\x0e</span><span class="s1">cMD_clustering</span><span class="se">\x94</span><span class="s1">}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n\x8c\x02</span><span class="s1">24</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x07\x8c\x02</span><span class="s1">55</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0f\x8c\x02</span><span class="s1">56</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0b</span><span class="s1">u</span><span class="se">\x8c\x0f</span><span class="s1">GaMD_clustering</span><span class="se">\x94</span><span class="s1">}</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x02</span><span class="s1">22</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x0c\x8c\x02</span><span class="s1">24</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\n\x8c\x02</span><span class="s1">56</span><span class="se">\x94</span><span class="s1">K u</span><span class="se">\x8c\n</span><span class="s1">md_methods</span><span class="se">\x94</span><span class="s1">]</span><span class="se">\x94</span><span class="s1">(</span><span class="se">\x8c\x03</span><span class="s1">cMD</span><span class="se">\x94\x8c\x04</span><span class="s1">GaMD</span><span class="se">\x94\x8c\x03</span><span class="s1">aMD</span><span class="se">\x94</span><span class="s1">e</span><span class="se">\x8c\x0b</span><span class="s1">cMD_repeats</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x01\x8c\x08</span><span class="s1">cMD_time</span><span class="se">\x94</span><span class="s1">Kd</span><span class="se">\x8c\x0b</span><span class="s1">aMD_repeats</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x01\x8c\x08</span><span class="s1">aMD_time</span><span class="se">\x94</span><span class="s1">Kd</span><span class="se">\x8c\x0c</span><span class="s1">GaMD_repeats</span><span class="se">\x94</span><span class="s1">K</span><span class="se">\x01\x8c\t</span><span class="s1">GaMD_time</span><span class="se">\x94</span><span class="s1">Kd</span><span class="se">\x8c\x08</span><span class="s1">md_times</span><span class="se">\x94</span><span class="s1">N</span><span class="se">\x8c\x04</span><span class="s1">em_1</span><span class="se">\x94</span><span class="s1">X</span><span class="se">\xc7\x01\x00\x00</span><span class="s1">Minimize water</span><span class="se">\n</span><span class="s1"> System minimization.</span><span class="se">\n</span><span class="s1">&amp;cntrl</span><span class="se">\n</span><span class="s1">   imin=1, ntmin=1, !(Invoke Minimization)</span><span class="se">\n</span><span class="s1">   ntx=1, irest=0, !(read init. coords, no restart)</span><span class="se">\n</span><span class="s1">   maxcyc=20000, ncyc=15000, !(max. cycles switch to conj. grad.)</span><span class="se">\n</span><span class="s1">   drms=0.1, !(convergence criterion)</span><span class="se">\n</span><span class="s1">   ntpr=100, ntwr=100, iwrap=0, !(outputs)</span><span class="se">\n</span><span class="s1">   ntf=1, !(force eval all)</span><span class="se">\n</span><span class="s1">   cut=8.0, !(non-bonded cutoff)</span><span class="se">\n</span><span class="s1">   ntr=1, !(cartesian restraints)</span><span class="se">\n</span><span class="s1">   restraintmask=&quot;!:WAT&quot;, restraint_wt=10.0, !(restrain all but water)</span><span class="se">\n</span><span class="s1"> /</span><span class="se">\n\x94\x8c\x04</span><span class="s1">em_2</span><span class="se">\x94</span><span class="s1">X</span><span class="se">\xb3\x01\x00\x00</span><span class="s1">Relax water</span><span class="se">\n</span><span class="s1"> LET WATER MOVE</span><span class="se">\n</span><span class="s1">&amp;cntrl</span><span class="se">\n</span><span class="s1">  imin=0,</span><span class="se">\n</span><span class="s1">  ntx=1, irest=0,</span><span class="se">\n</span><span class="s1">  ntpr=500, ntwx=500, ntwv=0, ntwe=0,</span><span class="se">\n</span><span class="s1">  ntwr=5000, !(outputs)</span><span class="se">\n</span><span class="s1">  t=0.0, dt=0.002, !(timestep)</span><span class="se">\n</span><span class="s1">  nstlim=10000, iwrap=1, !(steps, wrap to box)</span><span class="se">\n</span><span class="s1">  ntt=1, !(temp. control)</span><span class="se">\n</span><span class="s1">  temp0=300.0, tempi=200.0, tautp=0.5,</span><span class="se">\n</span><span class="s1">  ntp=1, pres0=1.0 !(pressure control)</span><span class="se">\n</span><span class="s1">  ntc=2, ntf=2, !(SHAKE)</span><span class="se">\n</span><span class="s1">  ntr=1, !(cart. restraints)</span><span class="se">\n</span><span class="s1">  restraintmask=&quot;!:WAT&quot; , restraint_wt=10.0, !(restrain all but water)</span><span class="se">\n</span><span class="s1"> /</span><span class="se">\n\x94</span><span class="s1">u</span><span class="se">\x8c\x04</span><span class="s1">rule</span><span class="se">\x94\x8c\x10</span><span class="s1">md_comp_analysis</span><span class="se">\x94\x8c\x0f</span><span class="s1">bench_iteration</span><span class="se">\x94</span><span class="s1">N</span><span class="se">\x8c\t</span><span class="s1">scriptdir</span><span class="se">\x94\x8c</span><span class="s1">5/biggin/b147/univ4859/research/03_macroconf/notebooks</span><span class="se">\x94</span><span class="s1">ub.&#39;</span><span class="p">);</span> <span class="kn">from</span> <span class="nn">snakemake.logging</span> <span class="kn">import</span> <span class="n">logger</span><span class="p">;</span> <span class="n">logger</span><span class="o">.</span><span class="n">printshellcmds</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">os</span><span class="p">;</span> <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/biggin/b147/univ4859/research/03_macroconf&#39;</span><span class="p">);</span>
<span class="c1">######## snakemake preamble end #########</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1">#matplotlib.use(&quot;Agg&quot;)</span>

<span class="kn">import</span> <span class="nn">mdtraj</span> <span class="k">as</span> <span class="nn">md</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.cluster.hierarchy</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">squareform</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="kn">import</span> <span class="nn">src</span>
<span class="kn">from</span> <span class="nn">src.noe</span> <span class="kn">import</span> <span class="n">compute_NOE_mdtraj</span><span class="p">,</span> <span class="n">plot_NOE</span>
<span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">json_load</span><span class="p">,</span> <span class="n">dotdict</span>

<span class="kn">import</span> <span class="nn">src.pyreweight</span>
<span class="kn">from</span> <span class="nn">src.analyse</span> <span class="kn">import</span> <span class="n">getDih</span><span class="p">,</span> <span class="n">getOmega</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in stride from config file</span>
<span class="n">stride</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">])</span>
<span class="n">stride</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compound_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">wildcards</span><span class="o">.</span><span class="n">compound_dir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analysing Compound </span><span class="si">{</span><span class="n">compound_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Analysing Compound 22
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compound</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">parm</span><span class="p">)</span>
<span class="n">multi</span> <span class="o">=</span> <span class="n">compound</span><span class="o">.</span><span class="n">multi</span>
<span class="n">multi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">multi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">multi</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">multi</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">multiple</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multiple compounds detected&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">multiple</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Single compound only (no exp. cis/trans data known)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Single compound only (no exp. cis/trans data known)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Trajectories</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;data/interim/refactor-test/22/NOE.json&#39;,
 &#39;data/interim/refactor-test/22/data.json&#39;,
 &#39;data/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_weights.dat&#39;,
 &#39;data/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_md.out&#39;,
 &#39;data/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_traj.netcdf&#39;,
 &#39;data/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_traj.ncdf&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_clusters/clusters.pdb&#39;,
 &#39;data/interim/refactor-test/22/H2O/1_make_topology/mc_sol.prmtop&#39;,
 &#39;data/interim/refactor-test/22/omega/basic/mcs.pdb&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_dihedrals.dat&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_dPCA.dat&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_dPCA_weights_MC.dat&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_NOE_dist.dat&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_multiple.dat&#39;,
 &#39;data/interim/refactor-test/22/H2O/11_GaMD_full/1000/0/8374da5ea9cc35c0_weights.dat&#39;,
 &#39;data/interim/refactor-test/22/H2O/11_GaMD_full/1000/0/8374da5ea9cc35c0_md.out&#39;,
 &#39;data/interim/refactor-test/22/H2O/11_GaMD_full/1000/0/8374da5ea9cc35c0_traj.netcdf&#39;,
 &#39;data/interim/refactor-test/22/H2O/11_GaMD_full/1000/0/8374da5ea9cc35c0_traj.ncdf&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_clusters/clusters.pdb&#39;,
 &#39;data/interim/refactor-test/22/H2O/1_make_topology/mc_sol.prmtop&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_dihedrals.dat&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_dPCA.dat&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_dPCA_weights_MC.dat&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_NOE_dist.dat&#39;,
 &#39;data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_multiple.dat&#39;,
 &#39;data/interim/refactor-test/22/Chloroform/11_GaMD_full/1000/0/d236cb661a6d3813_weights.dat&#39;,
 &#39;data/interim/refactor-test/22/Chloroform/11_GaMD_full/1000/0/d236cb661a6d3813_md.out&#39;,
 &#39;data/interim/refactor-test/22/Chloroform/11_GaMD_full/1000/0/d236cb661a6d3813_traj.netcdf&#39;,
 &#39;data/interim/refactor-test/22/Chloroform/11_GaMD_full/1000/0/d236cb661a6d3813_traj.ncdf&#39;,
 &#39;data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_clusters/clusters.pdb&#39;,
 &#39;data/interim/refactor-test/22/Chloroform/1_make_topology/mc_sol.prmtop&#39;,
 &#39;data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_dihedrals.dat&#39;,
 &#39;data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_dPCA.dat&#39;,
 &#39;data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_dPCA_weights_MC.dat&#39;,
 &#39;data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_NOE_dist.dat&#39;,
 &#39;data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_multiple.dat&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#trajs = {}</span>
<span class="n">methods</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">repeats</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">simtime</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">solvent</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">boosting</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="c1">#protein = md.load_frame(snakemake.input[f&quot;traj_{i}&quot;], 0, top=snakemake.input[f&quot;top_{i}&quot;])</span>
    <span class="c1">#protein = protein.topology.select(&#39;protein&#39;)</span>
    <span class="c1"># Load topology</span>
    <span class="c1">#trajs[i] = md.load(snakemake.input[f&quot;traj_{i}&quot;], top=snakemake.input[f&quot;top_{i}&quot;], atom_indices=protein, stride=stride)</span>
    <span class="c1"># save methods</span>
    <span class="n">methods</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sample_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s1">&#39;method&#39;</span><span class="p">]</span>
    <span class="n">simtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sample_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s1">&#39;simtime&#39;</span><span class="p">]</span>
    <span class="n">repeats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sample_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s1">&#39;repeats&#39;</span><span class="p">]</span>
    <span class="n">solvent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sample_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s1">&#39;solvent&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sample_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s1">&#39;igamd&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;nan&quot;</span><span class="p">:</span>
        <span class="n">boost</span> <span class="o">=</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sample_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s1">&#39;igamd&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">boost</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">boosting</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;boost: dual&quot;</span>
        <span class="k">elif</span> <span class="n">boost</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">boosting</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;boost: dihe&quot;</span>
        <span class="k">elif</span> <span class="n">boost</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">boosting</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;boost: totE&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">boosting</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    
    <span class="c1"># Remove solvent</span>
    <span class="c1">#trajs[i] = trajs[i].restrict_atoms(trajs[i].topology.select(&#39;protein&#39;))</span>
    <span class="c1">#if snakemake.params[f&quot;sample_{i}&quot;][&#39;method&#39;] == &quot;GaMD&quot;:</span>
        <span class="c1">#trajs[i] = trajs[i][int(26000/stride):]</span>
        <span class="c1">#print(&quot;GAMD&quot;)</span>
    <span class="c1"># Superpose</span>
    <span class="c1">#trajs[i].superpose(trajs[i], 0)</span>
    <span class="c1">#snakemake.input[f&quot;out_{i}&quot;]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#trajs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;out_0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;data/interim/refactor-test/22/H2O/11_GaMD_full/2000/0/ed6dd3148ef9b069_md.out&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">wildcards</span><span class="o">.</span><span class="n">confgen</span> <span class="o">!=</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
    <span class="n">chem_info_t</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">cheminfoconfs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">chem_info_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;mdtraj.Trajectory with 400 frames, 71 atoms, 5 residues, without unitcells&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">multiple</span><span class="p">:</span>
    <span class="n">cis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="c1">#         ca_c = trajs[i].top.select(f&quot;resid 0 and name CA C&quot;)</span>
<span class="c1">#         n_ca_next = trajs[i].top.select(f&quot;resid 1 and name N CA&quot;)</span>

<span class="c1">#         omega = np.append(ca_c, n_ca_next)</span>
<span class="c1">#         t_omega_rad = md.compute_dihedrals(trajs[i], [omega])</span>
<span class="c1">#         t_omega_deg = np.abs(np.degrees(t_omega_rad))</span>
<span class="c1">#         plt.plot(t_omega_deg)</span>
<span class="c1">#         plt.hlines(90, 0, 50000, color=&#39;red&#39;)</span>
        <span class="n">cis_temp</span><span class="p">,</span> <span class="n">trans_temp</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pickle_load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;multiple_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
        <span class="n">cis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cis_temp</span><span class="p">)</span>
        <span class="n">trans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trans_temp</span><span class="p">)</span>
        <span class="c1">#t_a[trans]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dihe_all</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">dihe_all</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pickle_load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;red_dihe_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">wildcards</span><span class="o">.</span><span class="n">confgen</span> <span class="o">!=</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
    <span class="n">dihe_conf</span> <span class="o">=</span> <span class="n">getDih</span><span class="p">(</span><span class="n">chem_info_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dihe_all</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000000, 30)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dihe</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pickle_load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dPCA_1</span><span class="p">)</span><span class="c1">#PCA(n_components=2)</span>
<span class="n">dihe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dihe_all</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dihe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="c1"># Now apply the same transformation to second and third</span>
<span class="n">dihe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dihe_all</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">dihe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dihe_all</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">wildcards</span><span class="o">.</span><span class="n">confgen</span> <span class="o">!=</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
    <span class="n">dihe_red_conf</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dihe_conf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dihe</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dihe</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">methods</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="k">if</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">wildcards</span><span class="o">.</span><span class="n">confgen</span> <span class="o">!=</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dihe_red_conf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dihe_red_conf</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar_18_0.png" src="../_images/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar_18_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How much of the variance is explained by the 2 components?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The two components explain </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2"> of the variance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The two components explain 52.66% of the variance
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#snakemake.input[f&quot;weights_{1}&quot;]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reweighting:</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">weight_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pickle_load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;dPCA_weights_MC_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
<span class="c1">#     if methods[i] != &#39;cMD&#39;:</span>
<span class="c1">#         weight_data[i] = np.loadtxt(snakemake.input[f&quot;weights_{i}&quot;])</span>
<span class="c1">#         weight_data[i] = weight_data[i][::stride]</span>
<span class="c1">#         weights[i] = src.reweight(dihe[i], snakemake.input[f&quot;weights_{i}&quot;], &#39;amdweight_MC&#39;, weight_data[i])</span>
<span class="c1">#     else:</span>
<span class="c1">#         weights[i] = src.reweight(dihe[i], None, &#39;noweight&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13.474566392729406
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">min_</span><span class="p">,</span> <span class="n">max_</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">zs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">min_</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">max_</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot re-weighted PCA plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">scat</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">scat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dihe</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dihe</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">min_</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">methods</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">simtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> ns (r# </span><span class="si">{</span><span class="n">repeats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">).</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">solvent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">boosting</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dihe</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dihe</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">wildcards</span><span class="o">.</span><span class="n">confgen</span> <span class="o">!=</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dihe_red_conf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dihe_red_conf</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">snakemake</span><span class="o">.</span><span class="n">wildcards</span><span class="o">.</span><span class="n">confgen</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">snakemake</span><span class="o">.</span><span class="n">wildcards</span><span class="o">.</span><span class="n">mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="n">lgnd</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
    <span class="n">handle</span><span class="o">.</span><span class="n">set_sizes</span><span class="p">([</span><span class="mf">30.0</span><span class="p">])</span>
    <span class="n">handle</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>



<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Overlay&#39;</span><span class="p">)</span>

<span class="n">colorbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;kcal/mol&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="c1">#fig.tight_layout()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">pca_dihe</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar_26_0.png" src="../_images/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar_26_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load cluster data</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;clusters_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">clust_struct</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;clusters_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">clust_struct</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">clusters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clust_struct</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data/processed/refactor-test/results/22/H2O/GaMD/2000/0/ed6dd3148ef9b069_clusters/clusters.pdb
data/processed/refactor-test/results/22/H2O/GaMD/1000/0/8374da5ea9cc35c0_clusters/clusters.pdb
data/processed/refactor-test/results/22/Chloroform/GaMD/1000/0/d236cb661a6d3813_clusters/clusters.pdb
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transform clusters in pca</span>
<span class="n">clusters_dih</span> <span class="o">=</span> <span class="p">[]</span>
<span class="p">[</span><span class="n">clusters_dih</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">getDih</span><span class="p">(</span><span class="n">clus</span><span class="p">))</span> <span class="k">for</span> <span class="n">clus</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">]</span>
<span class="n">cluster_pca</span> <span class="o">=</span> <span class="p">[]</span>
<span class="p">[</span><span class="n">cluster_pca</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">clus</span><span class="p">))</span> <span class="k">for</span> <span class="n">clus</span> <span class="ow">in</span> <span class="n">clusters_dih</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[None, None, None]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot Clusters</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dihe</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dihe</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="c1"># Plot clusters</span>
<span class="k">for</span> <span class="n">clus</span><span class="p">,</span> <span class="n">method</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cluster_pca</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">methods</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">clus</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">clus</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">clus</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">clus</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">clus</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Different clusters on dPCA plot&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">cluster_pca</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar_29_0.png" src="../_images/ed6dd3148ef9b069_8374da5ea9cc35c0_d236cb661a6d3813_omega_basic_compar_29_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Backbone RMSD between clusters. Array indices correspond to the cluster number in plot above.&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations_with_replacement</span>
<span class="n">cluster_pairs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations_with_replacement</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">method_pairs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations_with_replacement</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">methods</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cluster_pairs</span><span class="p">,</span> <span class="n">method_pairs</span><span class="p">):</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">i_n</span><span class="p">,</span> <span class="n">j_n</span> <span class="o">=</span> <span class="n">w</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSD between </span><span class="si">{</span><span class="n">i_n</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">j_n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">rmsd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">i</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="n">j</span><span class="o">.</span><span class="n">n_frames</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">n_frames</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">n_frames</span><span class="p">):</span>
            <span class="n">rmsd</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">j</span><span class="p">[</span><span class="n">b</span><span class="p">],</span> <span class="n">atom_indices</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;backbone&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rmsd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Backbone RMSD between clusters. Array indices correspond to the cluster number in plot above.
RMSD between GaMD - GaMD
[[0.00000000e+00 1.21022213e+00 1.35723615e+00 1.03750694e+00
  1.44424808e+00 1.54721403e+00 1.34796882e+00 1.04486990e+00
  1.35072482e+00 8.27648282e-01 1.38940382e+00 1.25898898e+00
  1.29147112e+00 8.71032000e-01 1.26768816e+00 1.16353226e+00
  1.40258491e+00]
 [1.21022213e+00 0.00000000e+00 6.79472804e-01 5.91886699e-01
  1.45834506e+00 1.77104568e+00 1.76767802e+00 1.56117499e+00
  1.31897092e+00 1.46207821e+00 1.43353999e+00 1.64951026e+00
  1.70039773e+00 1.29005814e+00 8.58871996e-01 1.70099866e+00
  1.73840773e+00]
 [1.35723615e+00 6.79472804e-01 0.00000000e+00 9.05123889e-01
  1.37692153e+00 1.59790766e+00 1.68821228e+00 1.72049940e+00
  1.43183887e+00 1.46739113e+00 1.17808366e+00 1.69609964e+00
  1.80019069e+00 1.45066500e+00 1.05815685e+00 1.82808816e+00
  1.73901689e+00]
 [1.03750694e+00 5.91886699e-01 9.05123889e-01 0.00000000e+00
  1.43878567e+00 1.71668673e+00 1.60356236e+00 1.55115080e+00
  1.38883734e+00 1.32914197e+00 1.25670063e+00 1.71072948e+00
  1.75486028e+00 1.25879478e+00 7.95539618e-01 1.61796260e+00
  1.70377111e+00]
 [1.44424808e+00 1.45834506e+00 1.37692153e+00 1.43878567e+00
  0.00000000e+00 1.05184448e+00 1.39211416e+00 1.81983018e+00
  9.79789555e-01 1.56632650e+00 1.38577890e+00 1.76606607e+00
  1.80165470e+00 1.75867343e+00 1.74491656e+00 1.92834961e+00
  1.96058857e+00]
 [1.54721403e+00 1.77104568e+00 1.59790766e+00 1.71668673e+00
  1.05184448e+00 0.00000000e+00 7.44550467e-01 1.50904894e+00
  1.48072851e+00 1.49227881e+00 1.47026348e+00 1.45428824e+00
  1.72079515e+00 1.90232337e+00 1.93198276e+00 1.76829147e+00
  1.51956201e+00]
 [1.34796929e+00 1.76767766e+00 1.68821192e+00 1.60356236e+00
  1.39211464e+00 7.44550467e-01 0.00000000e+00 1.27416563e+00
  1.67132044e+00 1.33244336e+00 1.36388493e+00 1.43582797e+00
  1.66474628e+00 1.70392013e+00 1.82027757e+00 1.52198017e+00
  1.35088813e+00]
 [1.04486990e+00 1.56117499e+00 1.72049940e+00 1.55115056e+00
  1.81983054e+00 1.50904894e+00 1.27416563e+00 0.00000000e+00
  1.73059404e+00 1.20836592e+00 1.79410470e+00 6.68986320e-01
  1.05799127e+00 1.37805092e+00 1.73939395e+00 1.00934064e+00
  1.03433597e+00]
 [1.35072482e+00 1.31897092e+00 1.43183935e+00 1.38883734e+00
  9.79789555e-01 1.48072851e+00 1.67132044e+00 1.73059404e+00
  0.00000000e+00 1.72134233e+00 1.72799480e+00 1.81227207e+00
  1.72495472e+00 1.56339538e+00 1.59697795e+00 1.68999910e+00
  2.08204961e+00]
 [8.27648938e-01 1.46207821e+00 1.46739113e+00 1.32914245e+00
  1.56632650e+00 1.49227881e+00 1.33244336e+00 1.20836592e+00
  1.72134233e+00 1.09183008e-03 1.09582484e+00 1.28317952e+00
  1.49518263e+00 1.22296464e+00 1.53098869e+00 1.43846107e+00
  9.38737094e-01]
 [1.38940430e+00 1.43353999e+00 1.17808318e+00 1.25670063e+00
  1.38577926e+00 1.47026372e+00 1.36388493e+00 1.79410470e+00
  1.72799480e+00 1.09582484e+00 0.00000000e+00 1.81130123e+00
  1.89112878e+00 1.57545674e+00 1.39604163e+00 1.80129862e+00
  1.47700918e+00]
 [1.25898850e+00 1.64951026e+00 1.69609964e+00 1.71072912e+00
  1.76606607e+00 1.45428777e+00 1.43582797e+00 6.68986320e-01
  1.81227207e+00 1.28317952e+00 1.81130123e+00 0.00000000e+00
  9.51204002e-01 1.57533872e+00 1.92373621e+00 1.33710527e+00
  9.23144758e-01]
 [1.29147112e+00 1.70039773e+00 1.80019069e+00 1.75486076e+00
  1.80165470e+00 1.72079515e+00 1.66474628e+00 1.05799127e+00
  1.72495425e+00 1.49518263e+00 1.89112878e+00 9.51203346e-01
  0.00000000e+00 1.12051928e+00 1.65307224e+00 8.83095503e-01
  1.42351651e+00]
 [8.71032000e-01 1.29005814e+00 1.45066500e+00 1.25879478e+00
  1.75867343e+00 1.90232337e+00 1.70392013e+00 1.37805045e+00
  1.56339538e+00 1.22296429e+00 1.57545698e+00 1.57533872e+00
  1.12051880e+00 0.00000000e+00 9.45833027e-01 9.33270752e-01
  1.69597054e+00]
 [1.26768816e+00 8.58871996e-01 1.05815685e+00 7.95539618e-01
  1.74491632e+00 1.93198276e+00 1.82027757e+00 1.73939359e+00
  1.59697795e+00 1.53098834e+00 1.39604163e+00 1.92373621e+00
  1.65307260e+00 9.45833027e-01 0.00000000e+00 1.43220723e+00
  1.91783667e+00]
 [1.16353226e+00 1.70099866e+00 1.82808816e+00 1.61796260e+00
  1.92834961e+00 1.76829147e+00 1.52197969e+00 1.00934064e+00
  1.68999887e+00 1.43846107e+00 1.80129862e+00 1.33710527e+00
  8.83095503e-01 9.33270752e-01 1.43220723e+00 0.00000000e+00
  1.54103947e+00]
 [1.40258491e+00 1.73840749e+00 1.73901689e+00 1.70377111e+00
  1.96058857e+00 1.51956201e+00 1.35088813e+00 1.03433597e+00
  2.08204961e+00 9.38737690e-01 1.47700918e+00 9.23144102e-01
  1.42351651e+00 1.69597054e+00 1.91783667e+00 1.54103947e+00
  0.00000000e+00]]
RMSD between GaMD - GaMD
[[1.18969905 1.29972589 1.00273824 0.1968143  1.29032087 0.87240845
  1.40313756 1.63978922 1.45187616 1.36142492 1.77287316 1.49259281
  1.46435332 1.04547906]
 [0.21178408 0.6967895  0.63821554 1.1466285  1.31935132 1.49283195
  1.37622046 1.50320697 1.79498625 1.78295493 1.72703087 1.91355014
  1.58647609 1.68375731]
 [0.70834959 0.22421362 0.93765825 1.33934093 1.4938035  1.4935298
  1.12488604 1.24287438 1.72599506 1.75536799 1.64199483 1.89212799
  1.66340256 1.77188015]
 [0.58161551 0.89923728 0.43381941 1.00646484 1.39761925 1.3146354
  1.2016834  1.38996267 1.75805283 1.74824429 1.73950183 1.91428077
  1.58462048 1.6241796 ]
 [1.44122267 1.36738014 1.27923667 1.48678315 1.00274229 1.46811891
  1.28418708 1.5024966  1.88583684 1.89214337 1.42270982 1.58624911
  1.0698837  1.80795193]
 [1.70149267 1.60691452 1.56814277 1.57401991 1.48846793 1.38607609
  1.4058311  1.63218558 1.36707199 1.34642076 1.38319957 1.24005556
  1.23983788 1.45673382]
 [1.67966616 1.71683145 1.60963464 1.36181414 1.65477288 1.25283062
  1.32433534 1.55945969 1.233724   1.20180583 1.61923003 1.3588078
  1.43311965 1.19553792]
 [1.50421572 1.66940856 1.47490966 1.00079429 1.63549912 1.25777411
  1.855775   2.07829881 1.15403497 0.96203363 1.73486018 1.17335367
  1.43897605 0.3216399 ]
 [1.30674183 1.45498347 1.23390269 1.37465131 0.26699209 1.68441391
  1.60483122 1.79533958 2.06949592 1.96861601 1.55393386 1.5692687
  0.83757389 1.72445047]
 [1.43392205 1.38961697 1.32899892 0.85283947 1.66392684 0.2932514
  1.18865597 1.44248188 0.98855013 0.93093222 1.68472397 1.34629953
  1.71530497 1.17118049]
 [1.41935468 1.15222275 1.34253049 1.43894553 1.76885366 1.04237461
  0.31205529 0.69692636 1.40933442 1.48094702 1.59840596 1.73301673
  1.7679069  1.72564018]
 [1.6137104  1.61126673 1.57438493 1.21386218 1.7259655  1.32785797
  1.90590632 2.1153152  0.98954082 1.04167914 1.68485546 1.18739915
  1.47884667 0.77673942]
 [1.73126149 1.72920239 1.62486804 1.28035498 1.625368   1.55528045
  1.99892867 2.22900224 1.47004724 1.46898413 1.84917521 1.45617056
  1.48791289 1.10422683]
 [1.34474409 1.41529441 1.27903092 0.86557478 1.48907769 1.31589043
  1.63231003 1.84173417 1.76408148 1.65604711 2.06667924 1.78726578
  1.70603263 1.39261079]
 [0.93050188 1.08065748 0.92622721 1.25157726 1.59659529 1.57455182
  1.38745439 1.53614938 1.97259486 1.89125919 1.97134387 2.06042123
  1.83396935 1.7780087 ]
 [1.70239878 1.80181038 1.57054925 1.17826426 1.61686766 1.4977628
  1.85671663 2.08898091 1.62385714 1.40142548 1.88031268 1.44702256
  1.48406172 0.94408208]
 [1.69554567 1.67813361 1.7086457  1.36617255 2.02020454 1.00424099
  1.60297894 1.77622306 0.36915159 0.54763526 1.72044289 1.29326439
  1.8107866  1.04397392]]
RMSD between GaMD - GaMD
[[1.14480245]
 [0.47788742]
 [0.71971148]
 [0.73040003]
 [1.34663641]
 [1.61820638]
 [1.7223345 ]
 [1.46080005]
 [1.34824133]
 [1.30581236]
 [1.39814925]
 [1.44709539]
 [1.60406232]
 [1.34825099]
 [1.06340945]
 [1.7064302 ]
 [1.59067464]]
RMSD between GaMD - GaMD
[[0.00000000e+00 7.36356616e-01 6.27364457e-01 1.12534785e+00
  1.30496120e+00 1.45267904e+00 1.34166014e+00 1.47952890e+00
  1.73892546e+00 1.70840013e+00 1.68241155e+00 1.84679246e+00
  1.56730413e+00 1.62156725e+00]
 [7.36356616e-01 0.00000000e+00 8.81846607e-01 1.28272748e+00
  1.50179029e+00 1.41616678e+00 1.13074124e+00 1.28151774e+00
  1.67440963e+00 1.71192276e+00 1.62474585e+00 1.85048342e+00
  1.65603268e+00 1.72476602e+00]
 [6.27363563e-01 8.81846607e-01 0.00000000e+00 9.79364872e-01
  1.22478032e+00 1.28630745e+00 1.28525794e+00 1.52354383e+00
  1.73945558e+00 1.69707763e+00 1.63388789e+00 1.77911496e+00
  1.42125833e+00 1.55706871e+00]
 [1.12534785e+00 1.28272748e+00 9.79364872e-01 0.00000000e+00
  1.29792798e+00 9.12890077e-01 1.45734084e+00 1.68126607e+00
  1.43672681e+00 1.35347915e+00 1.83257842e+00 1.53050971e+00
  1.47752929e+00 1.03473175e+00]
 [1.30496120e+00 1.50179029e+00 1.22478032e+00 1.29792798e+00
  0.00000000e+00 1.62872612e+00 1.66041982e+00 1.86524415e+00
  2.02120876e+00 1.91209459e+00 1.61081195e+00 1.52585149e+00
  8.16939175e-01 1.64524889e+00]
 [1.45267904e+00 1.41616678e+00 1.28630745e+00 9.12890077e-01
  1.62872612e+00 0.00000000e+00 1.11382341e+00 1.42424822e+00
  9.96356964e-01 9.57619011e-01 1.64856029e+00 1.35441852e+00
  1.64769936e+00 1.21772337e+00]
 [1.34166014e+00 1.13074124e+00 1.28525794e+00 1.45734048e+00
  1.66041946e+00 1.11382341e+00 0.00000000e+00 6.11336112e-01
  1.52059507e+00 1.55848598e+00 1.54455650e+00 1.74207568e+00
  1.70387566e+00 1.78800726e+00]
 [1.47952890e+00 1.28151751e+00 1.52354383e+00 1.68126607e+00
  1.86524415e+00 1.42424822e+00 6.11336112e-01 0.00000000e+00
  1.72553480e+00 1.76806700e+00 1.53698611e+00 1.86919165e+00
  1.90645218e+00 2.01569629e+00]
 [1.73892546e+00 1.67440963e+00 1.73945558e+00 1.43672681e+00
  2.02120876e+00 9.96356964e-01 1.52059507e+00 1.72553480e+00
  0.00000000e+00 5.68054974e-01 1.65429401e+00 1.29109633e+00
  1.80766869e+00 1.13559616e+00]
 [1.70839977e+00 1.71192276e+00 1.69707799e+00 1.35347915e+00
  1.91209459e+00 9.57619011e-01 1.55848598e+00 1.76806700e+00
  5.68054974e-01 0.00000000e+00 1.63512337e+00 1.07467914e+00
  1.72873902e+00 8.90752017e-01]
 [1.68241155e+00 1.62474585e+00 1.63388789e+00 1.83257842e+00
  1.61081195e+00 1.64856029e+00 1.54455602e+00 1.53698611e+00
  1.65429401e+00 1.63512337e+00 1.09183008e-03 1.08515382e+00
  1.32334399e+00 1.68875265e+00]
 [1.84679246e+00 1.85048342e+00 1.77911496e+00 1.53050971e+00
  1.52585149e+00 1.35441852e+00 1.74207568e+00 1.86919212e+00
  1.29109573e+00 1.07467914e+00 1.08515334e+00 0.00000000e+00
  1.24572444e+00 1.07741892e+00]
 [1.56730413e+00 1.65603268e+00 1.42125833e+00 1.47752929e+00
  8.16939175e-01 1.64769936e+00 1.70387566e+00 1.90645218e+00
  1.80766869e+00 1.72873902e+00 1.32334399e+00 1.24572504e+00
  0.00000000e+00 1.42507005e+00]
 [1.62156725e+00 1.72476602e+00 1.55706871e+00 1.03473175e+00
  1.64524889e+00 1.21772337e+00 1.78800726e+00 2.01569629e+00
  1.13559616e+00 8.90752017e-01 1.68875229e+00 1.07741892e+00
  1.42507005e+00 0.00000000e+00]]
RMSD between GaMD - GaMD
[[0.50336802]
 [0.62971342]
 [0.56226492]
 [1.08862305]
 [1.32273805]
 [1.32247353]
 [1.3692795 ]
 [1.56050205]
 [1.63240683]
 [1.62743199]
 [1.61497951]
 [1.7464596 ]
 [1.54259062]
 [1.58846486]]
RMSD between GaMD - GaMD
[[0.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NOE</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">noe</span><span class="o">.</span><span class="n">read_NOE</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">noe</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOE_dist = {}</span>
<span class="c1"># NOE_store = {}</span>
<span class="c1"># NOE_dist_cis={}</span>
<span class="c1"># NOE_dist_trans={}</span>
<span class="c1"># NOE_store_cis = {}</span>
<span class="c1"># NOE_store_trans = {}</span>
<span class="c1"># for i in range(3):</span>
<span class="c1">#     NOE_output = {}</span>
<span class="c1">#     if methods[i] != &quot;cMD&quot;:</span>
<span class="c1">#         if multiple:</span>
<span class="c1">#             fig, axs = plt.subplots(2,1)</span>
<span class="c1">#             fig.set_size_inches(10,6)</span>
<span class="c1">#             NOE_trans, NOE_cis = NOE</span>
<span class="c1">#             NOE_cis_dict = NOE_cis.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#             NOE_trans_dict = NOE_trans.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#             if len(cis[i]) &gt; 0:</span>
<span class="c1">#                 NOE_cis[&#39;md&#39;],NOE_cis[&#39;lower&#39;],NOE_cis[&#39;upper&#39;],NOE_dist_cis[i], pmf_plot_cis = compute_NOE_mdtraj(NOE_cis_dict, trajs[i][cis[i]], snakemake.input[f&quot;weights_{i}&quot;], 1, weight_data=weight_data[i][cis[i]])</span>
<span class="c1">#                 NOE_output[f&quot;{multi[&#39;cis&#39;]}&quot;] = NOE_cis.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#                 # Deal with ambigous NOEs</span>
<span class="c1">#                 NOE_cis = NOE_cis.explode([&#39;md&#39;, &#39;lower&#39;, &#39;upper&#39;])</span>
<span class="c1">#                 # and ambigous/multiple values</span>
<span class="c1">#                 NOE_cis = NOE_cis.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#                 fig, axs[1] = plot_NOE(NOE_cis, fig, axs[1])</span>
<span class="c1">#                 axs[1].set_title(f&quot;Compound {multi[&#39;cis&#39;]} (cis)&quot;)</span>
<span class="c1">#                 NOE_store_cis[i] = NOE_cis</span>
<span class="c1">#             else:</span>
<span class="c1">#                 print(&quot;Cis skipped because no frames are cis.&quot;)</span>
<span class="c1">#             if len(trans[i]) &gt; 0:</span>
<span class="c1">#                 NOE_trans[&#39;md&#39;],NOE_trans[&#39;lower&#39;],NOE_trans[&#39;upper&#39;],NOE_dist_trans[i], pmf_plot_trans = compute_NOE_mdtraj(NOE_trans_dict, trajs[i][trans[i]], snakemake.input[f&quot;weights_{i}&quot;], 1, weight_data=weight_data[i][trans[i]])</span>
<span class="c1">#                 NOE_output[f&quot;{multi[&#39;trans&#39;]}&quot;] = NOE_trans.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#                 # Deal with ambigous NOEs</span>
<span class="c1">#                 NOE_trans = NOE_trans.explode([&#39;md&#39;, &#39;lower&#39;, &#39;upper&#39;])</span>
<span class="c1">#                 # and ambigous/multiple values</span>
<span class="c1">#                 NOE_trans = NOE_trans.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#                 fig, axs[0] = plot_NOE(NOE_trans, fig, axs[0])</span>
<span class="c1">#                 axs[0].set_title(f&quot;Compound {multi[&#39;trans&#39;]} (trans)&quot;)</span>
<span class="c1">#                 NOE_store_trans[i] = NOE_trans</span>
<span class="c1">#             else:</span>
<span class="c1">#                 print(&quot;Trans skipped because no frames are cis&quot;)</span>
<span class="c1">#             #NOE_output = {f&quot;{multi[cis]}&quot;: NOE_cis, f&quot;{multi[trans]}&quot;: NOE_trans}</span>
<span class="c1">#             #src.utils.json_dump(snakemake.output.noe_result, NOE_output)</span>
<span class="c1">#         else:</span>
<span class="c1">#             NOE = src.noe.read_NOE(snakemake.input.noe)</span>
<span class="c1">#             NOE_dict = NOE.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#             NOE[&#39;md&#39;], NOE[&#39;lower&#39;], NOE[&#39;upper&#39;], NOE_dist[i], pmf_plot = src.noe.compute_NOE_mdtraj(NOE_dict, trajs[i], snakemake.input[f&quot;weights_{i}&quot;], 1, weight_data=weight_data[i])</span>
<span class="c1">#             plt.close()</span>
<span class="c1">#             # Save NOE dict</span>
<span class="c1">#             NOE_output = {f&quot;{compound_index}&quot;: NOE.to_dict(orient=&#39;index&#39;)}</span>
<span class="c1">#             # save as .json file</span>
<span class="c1">#             #src.utils.json_dump(snakemake.output.noe_result, NOE_output)</span>
<span class="c1">#             # Deal with ambigous NOEs</span>
<span class="c1">#             #NOE = NOE.explode(&#39;md&#39;)</span>
<span class="c1">#             NOE = NOE.explode([&#39;md&#39;, &#39;lower&#39;, &#39;upper&#39;])</span>
<span class="c1">#             # and ambigous/multiple values</span>
<span class="c1">#             NOE = NOE.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#             fig, ax = plot_NOE(NOE)</span>
<span class="c1">#             ax.set_title(f&quot;Compound {compound_index}. NOE&quot;)</span>
<span class="c1">#             fig.tight_layout()</span>
<span class="c1">#             #fig.savefig(snakemake.output.noe_plot)</span>
<span class="c1">#             NOE_store[i] = NOE</span>
<span class="c1">#     else:</span>
<span class="c1">#         print(&quot;cMD - no reweighted NOEs performed.&quot;)</span>
<span class="c1">#         if multiple:</span>
<span class="c1">#             fig, axs = plt.subplots(2,1)</span>
<span class="c1">#             fig.set_size_inches(10,6)</span>
<span class="c1">#             NOE_trans, NOE_cis = NOE</span>
<span class="c1">#             NOE_cis_dict = NOE_cis.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#             NOE_trans_dict = NOE_trans.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#             if len(cis[i]) &gt; 0:</span>
<span class="c1">#                 NOE_cis[&#39;md&#39;],_,_2,NOE_dist_cis, pmf_plot_cis = compute_NOE_mdtraj(NOE_cis_dict, t[cis[i]], snakemake.input.weights, 1, cis[i])</span>
<span class="c1">#                 NOE_output[f&quot;{multi[&#39;cis&#39;]}&quot;] = NOE_cis.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#                 # Deal with ambigous NOEs</span>
<span class="c1">#                 NOE_cis = NOE_cis.explode(&#39;md&#39;)</span>
<span class="c1">#                 # and ambigous/multiple values</span>
<span class="c1">#                 NOE_cis = NOE_cis.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#                 fig, axs[1] = plot_NOE(NOE_cis, fig, axs[1])</span>
<span class="c1">#                 axs[1].set_title(f&quot;Compound {multi[&#39;cis&#39;]} (cis)&quot;)</span>
<span class="c1">#             else:</span>
<span class="c1">#                 print(&quot;Cis skipped because no frames are cis.&quot;)</span>
<span class="c1">#             if len(trans[i]) &gt; 0:</span>
<span class="c1">#                 NOE_trans[&#39;md&#39;],_,_2,NOE_dist_trans, pmf_plot_trans = compute_NOE_mdtraj(NOE_trans_dict, t[trans[i]], snakemake.input.weights, 1, trans[i])</span>
<span class="c1">#                 NOE_output[f&quot;{multi[&#39;trans&#39;]}&quot;] = NOE_trans.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#                 # Deal with ambigous NOEs</span>
<span class="c1">#                 NOE_trans = NOE_trans.explode(&#39;md&#39;)</span>
<span class="c1">#                 # and ambigous/multiple values</span>
<span class="c1">#                 NOE_trans = NOE_trans.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#                 fig, axs[0] = plot_NOE(NOE_trans, fig, axs[0])</span>
<span class="c1">#                 axs[0].set_title(f&quot;Compound {multi[&#39;trans&#39;]} (trans)&quot;)</span>
<span class="c1">#             else:</span>
<span class="c1">#                 print(&quot;Trans skipped because no frames are cis&quot;)</span>
<span class="c1">#             #NOE_output = {f&quot;{multi[cis]}&quot;: NOE_cis, f&quot;{multi[trans]}&quot;: NOE_trans}</span>
<span class="c1">#             src.utils.json_dump(snakemake.output.noe_result, NOE_output)</span>
<span class="c1">#         else:</span>
<span class="c1">#             NOE = src.noe.read_NOE(snakemake.input.noe)</span>
<span class="c1">#             NOE_dict = NOE.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#             NOE[&#39;md&#39;], NOE[&#39;lower&#39;], NOE[&#39;upper&#39;], NOE_dist[i], pmf_plot = src.noe.compute_NOE_mdtraj(NOE_dict, trajs[i])</span>
<span class="c1">#             plt.close()</span>
<span class="c1">#             # Save NOE dict</span>
<span class="c1">#             NOE_output = {f&quot;{compound_index}&quot;: NOE.to_dict(orient=&#39;index&#39;)}</span>
<span class="c1">#             # save as .json file</span>
<span class="c1">#             #src.utils.json_dump(snakemake.output.noe_result, NOE_output)</span>
<span class="c1">#             # Deal with ambigous NOEs</span>
<span class="c1">#             #NOE = NOE.explode(&#39;md&#39;)</span>
<span class="c1">#             NOE = NOE.explode([&#39;md&#39;, &#39;lower&#39;, &#39;upper&#39;])</span>
<span class="c1">#             # and ambigous/multiple values</span>
<span class="c1">#             NOE = NOE.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#             fig, ax = plot_NOE(NOE)</span>
<span class="c1">#             ax.set_title(f&quot;Compound {compound_index}. NOE&quot;)</span>
<span class="c1">#             fig.tight_layout()</span>
<span class="c1">#             #fig.savefig(snakemake.output.noe_plot)</span>
<span class="c1">#             NOE_store[i] = NOE</span>
<span class="c1">#     print(f&quot;Done {i}&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NOE</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">noe</span><span class="o">.</span><span class="n">read_NOE</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">noe</span><span class="p">)</span>
<span class="n">NOE</span> <span class="o">=</span> <span class="n">NOE</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;NMR exp&#39;</span><span class="p">)</span>
<span class="n">NOE_dist</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">NOE_store</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">NOE_dist_cis</span><span class="o">=</span><span class="p">{}</span>
<span class="n">NOE_dist_trans</span><span class="o">=</span><span class="p">{}</span>
<span class="n">NOE_store_cis</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">NOE_store_trans</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">NOE_output</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">methods</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;cMD&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">multiple</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cis</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">NOE_dist_cis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pickle_load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;NOE_dist_</span><span class="si">{</span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])[</span><span class="n">cis</span><span class="p">]</span>
                <span class="c1">#NOE_store_cis[i] = NOE_cis</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cis skipped because no frames are cis.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trans</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">NOE_dist_trans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pickle_load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;NOE_dist_</span><span class="si">{</span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])[</span><span class="n">trans</span><span class="p">]</span>
                <span class="c1">#NOE_store_trans[i] = NOE_trans</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trans skipped because no frames are cis&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NOE_dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pickle_load</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;NOE_dist_</span><span class="si">{</span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
<span class="c1">#     </span>
<span class="c1">#     print(f&quot;Done {i}&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # plot PCA, colored by NOE</span>
<span class="c1"># NOE_select = 11</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting color deviation would be better maybe?</span>
<span class="c1"># activate below for plotting pca, colored by NOE value</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if not multiple:</span>
<span class="c1">#     for NOE_select in range(len(NOE_dist[0])):</span>
<span class="c1">#         if np.all(~np.isnan(NOE_dist[0][NOE_select][0])):</span>
<span class="c1">#             zs = np.concatenate([NOE_dist[0][NOE_select][0], NOE_dist[1][NOE_select][0], NOE_dist[2][NOE_select][0]], axis=0)</span>
<span class="c1">#         else:</span>
<span class="c1">#             zs=np.array([0,0])</span>
<span class="c1">#             min_, max_ = zs.min(), zs.max()</span>
<span class="c1">#             continue</span>
<span class="c1">#         # Plot re-weighted PCA plots</span>
<span class="c1">#         for a in range(len(NOE_dist[1][NOE_select])):</span>
<span class="c1">#             # here we select NOE_store[1], but 0, 2 could be used too (exp value is the same)</span>
<span class="c1">#             NOE_exp = NOE[NOE.index == str(NOE_select)][&#39;NMR exp&#39;][0]</span>
<span class="c1">#             #NOE_md = NOE_store[a][NOE_store[a].index == str(NOE_select)][&#39;md&#39;][a]</span>
<span class="c1">#             fig, axs = plt.subplots(1,4, sharex=&#39;all&#39;, sharey=&#39;all&#39;)</span>
<span class="c1">#             fig.set_size_inches(16,4)</span>
<span class="c1">#             fig.suptitle(f&quot;Compound {compound_index}. NOE #{NOE_select} (amb # {a}). exp={NOE_exp}.&quot;)</span>

<span class="c1">#             for i in range(3):</span>
<span class="c1">#                 scat = axs[i].scatter(dihe[i][:,0], dihe[i][:,1], c=NOE_dist[i][NOE_select][a], marker=&#39;.&#39;, s=0.5, vmin=0, vmax=8)</span>
<span class="c1">#                 axs[i].set_title(f&quot;{methods[i]}: {simtime[i]} ns (r# {repeats[i]})&quot;)</span>
<span class="c1">#                 axs[3].scatter(dihe[i][:,0], dihe[i][:,1], marker=&#39;.&#39;, s=0.5, alpha=0.1, label=methods[i])</span>

<span class="c1">#             lgnd = axs[3].legend()</span>
<span class="c1">#             for handle in lgnd.legendHandles:</span>
<span class="c1">#                 handle.set_sizes([30.0])</span>
<span class="c1">#                 handle.set_alpha(1)</span>

<span class="c1">#             axs[3].set_title(&#39;Overlay&#39;)</span>

<span class="c1">#             colorbar = fig.colorbar(scat, ax=axs, label=&quot;NOE [A]&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if not multiple:</span>
<span class="c1">#     for NOE_select in range(len(NOE_dist[0])):</span>
<span class="c1">#         if np.all(~np.isnan(NOE_dist[0][NOE_select][0])):</span>
<span class="c1">#             zs = np.concatenate([NOE_dist[0][NOE_select][0], NOE_dist[1][NOE_select][0], NOE_dist[2][NOE_select][0]], axis=0)</span>
<span class="c1">#         else:</span>
<span class="c1">#             zs=np.array([0,0])</span>
<span class="c1">#             min_, max_ = zs.min(), zs.max()</span>
<span class="c1">#             continue</span>
<span class="c1">#         # Plot re-weighted PCA plots</span>
<span class="c1">#         for a in range(len(NOE_dist[1][NOE_select])):</span>
<span class="c1">#             # here we select NOE_store[1], but 0, 2 could be used too (exp value is the same)</span>
<span class="c1">#             NOE_exp = NOE_store[1][NOE_store[1].index == str(NOE_select)][&#39;NMR exp&#39;][a]</span>
<span class="c1">#             #NOE_md = NOE_store[a][NOE_store[a].index == str(NOE_select)][&#39;md&#39;][a]</span>
<span class="c1">#             fig, axs = plt.subplots(1,4, sharex=&#39;all&#39;, sharey=&#39;all&#39;)</span>
<span class="c1">#             fig.set_size_inches(16,4)</span>
<span class="c1">#             fig.suptitle(f&quot;Compound {compound_index}. NOE #{NOE_select} (amb # {a}). exp={NOE_exp}.&quot;)</span>

<span class="c1">#             for i in range(3):</span>
<span class="c1">#                 scat = axs[i].scatter(dihe[i][:,0], dihe[i][:,1], c=NOE_dist[i][NOE_select][a], marker=&#39;.&#39;, s=0.5, vmin=0, vmax=8)</span>
<span class="c1">#                 axs[i].set_title(f&quot;{methods[i]}: {simtime[i]} ns (r# {repeats[i]})&quot;)</span>
<span class="c1">#                 axs[3].scatter(dihe[i][:,0], dihe[i][:,1], marker=&#39;.&#39;, s=0.5, alpha=0.1, label=methods[i])</span>

<span class="c1">#             lgnd = axs[3].legend()</span>
<span class="c1">#             for handle in lgnd.legendHandles:</span>
<span class="c1">#                 handle.set_sizes([30.0])</span>
<span class="c1">#                 handle.set_alpha(1)</span>

<span class="c1">#             axs[3].set_title(&#39;Overlay&#39;)</span>

<span class="c1">#             colorbar = fig.colorbar(scat, ax=axs, label=&quot;NOE [A]&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if not multiple:</span>
<span class="c1">#     zs = np.concatenate([weights[0], weights[1], weights[2]], axis=0)</span>
<span class="c1">#     min_, max_ = zs.min(), zs.max()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if not multiple:</span>
<span class="c1">#     # Plot NOE-PCA plots</span>
<span class="c1">#     for a in range(len(NOE_dist[1][NOE_select])):</span>
<span class="c1">#         NOE_exp = NOE_store[a][NOE_store[a].index == str(NOE_select)][&#39;NMR exp&#39;][a]</span>
<span class="c1">#         NOE_md = NOE_store[a][NOE_store[a].index == str(NOE_select)][&#39;md&#39;][a]</span>
<span class="c1">#         fig, axs = plt.subplots(1,4, sharex=&#39;all&#39;, sharey=&#39;all&#39;)</span>
<span class="c1">#         fig.set_size_inches(16,4)</span>
<span class="c1">#         fig.suptitle(f&quot;Compound {compound_index}. NOE #{NOE_select}. ambiguous NOE# {a}. exp={NOE_exp}. md={NOE_md}&quot;)</span>

<span class="c1">#         for i in range(3):</span>
<span class="c1">#             scat = axs[i].scatter(dihe[i][:,0], NOE_dist[i][NOE_select][a], c=weights[i], cmap=&#39;Spectral_r&#39;, marker=&#39;.&#39;, s=0.5, vmin=min_, vmax=max_)</span>
<span class="c1">#             axs[i].set_title(f&quot;{methods[i]}: {simtime[i]} ns (r# {repeats[i]})&quot;)</span>
<span class="c1">#             axs[3].scatter(dihe[i][:,0], dihe[i][:,1], marker=&#39;.&#39;, s=0.5, alpha=0.1, label=methods[i])</span>

<span class="c1">#         lgnd = axs[3].legend()</span>
<span class="c1">#         for handle in lgnd.legendHandles:</span>
<span class="c1">#             handle.set_sizes([30.0])</span>
<span class="c1">#             handle.set_alpha(1)</span>

<span class="c1">#         axs[3].set_title(&#39;Overlay&#39;)</span>

<span class="c1">#         colorbar = fig.colorbar(scat, ax=axs, label=&quot;kcal/mol&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># THIS WAS THE END OF THE SCRIPT. BELOW IS OLD.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # 1d PMF reweighted NOEs</span>
<span class="c1"># NOE_output = {}</span>
<span class="c1"># if snakemake.params.method != &quot;cMD&quot;:</span>
<span class="c1">#     if multiple:</span>
<span class="c1">#         fig, axs = plt.subplots(2,1)</span>
<span class="c1">#         fig.set_size_inches(10,6)</span>
<span class="c1">#         NOE_trans, NOE_cis = NOE</span>
<span class="c1">#         NOE_cis_dict = NOE_cis.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#         NOE_trans_dict = NOE_trans.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#         if len(cis) &gt; 0:</span>
<span class="c1">#             NOE_cis[&#39;md&#39;],_,_2,NOE_dist_cis, pmf_plot_cis = compute_NOE_mdtraj(NOE_cis_dict, t[cis], snakemake.input.weights, 1, cis)</span>
<span class="c1">#             NOE_output[f&quot;{multi[&#39;cis&#39;]}&quot;] = NOE_cis.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#             # Deal with ambigous NOEs</span>
<span class="c1">#             NOE_cis = NOE_cis.explode(&#39;md&#39;)</span>
<span class="c1">#             # and ambigous/multiple values</span>
<span class="c1">#             NOE_cis = NOE_cis.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#             fig, axs[1] = plot_NOE(NOE_cis, fig, axs[1])</span>
<span class="c1">#             axs[1].set_title(f&quot;Compound {multi[&#39;cis&#39;]} (cis)&quot;)</span>
<span class="c1">#         else:</span>
<span class="c1">#             print(&quot;Cis skipped because no frames are cis.&quot;)</span>
<span class="c1">#         if len(trans) &gt; 0:</span>
<span class="c1">#             NOE_trans[&#39;md&#39;],_,_2,NOE_dist_trans, pmf_plot_trans = compute_NOE_mdtraj(NOE_trans_dict, t[trans], snakemake.input.weights, 1, trans)</span>
<span class="c1">#             NOE_output[f&quot;{multi[&#39;trans&#39;]}&quot;] = NOE_trans.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#             # Deal with ambigous NOEs</span>
<span class="c1">#             NOE_trans = NOE_trans.explode(&#39;md&#39;)</span>
<span class="c1">#             # and ambigous/multiple values</span>
<span class="c1">#             NOE_trans = NOE_trans.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#             fig, axs[0] = plot_NOE(NOE_trans, fig, axs[0])</span>
<span class="c1">#             axs[0].set_title(f&quot;Compound {multi[&#39;trans&#39;]} (trans)&quot;)</span>
<span class="c1">#         else:</span>
<span class="c1">#             print(&quot;Trans skipped because no frames are cis&quot;)</span>
<span class="c1">#         #NOE_output = {f&quot;{multi[cis]}&quot;: NOE_cis, f&quot;{multi[trans]}&quot;: NOE_trans}</span>
<span class="c1">#         src.utils.json_dump(snakemake.output.noe_result, NOE_output)</span>
<span class="c1">#     else:</span>
<span class="c1">#         NOE = src.noe.read_NOE(NOE_path)</span>
<span class="c1">#         NOE_dict = NOE.to_dict(orient=&#39;index&#39;)</span>
<span class="c1">#         NOE[&#39;md&#39;], NOE[&#39;lower&#39;], NOE[&#39;upper&#39;], _, pmf_plot = src.noe.compute_NOE_mdtraj(NOE_dict, t, snakemake.input.weights, 1)</span>
<span class="c1">#         plt.close()</span>
<span class="c1">#         # Save NOE dict</span>
<span class="c1">#         NOE_output = {f&quot;{compound_index}&quot;: NOE.to_dict(orient=&#39;index&#39;)}</span>
<span class="c1">#         # save as .json file</span>
<span class="c1">#         src.utils.json_dump(snakemake.output.noe_result, NOE_output)</span>
<span class="c1">#         # Deal with ambigous NOEs</span>
<span class="c1">#         #NOE = NOE.explode(&#39;md&#39;)</span>
<span class="c1">#         NOE = NOE.explode([&#39;md&#39;, &#39;lower&#39;, &#39;upper&#39;])</span>
<span class="c1">#         # and ambigous/multiple values</span>
<span class="c1">#         NOE = NOE.explode(&#39;NMR exp&#39;)</span>
<span class="c1">#         fig, ax = plot_NOE(NOE)</span>
<span class="c1">#         ax.set_title(f&quot;Compound {compound_index}. NOE&quot;)</span>
<span class="c1">#         fig.tight_layout()</span>
<span class="c1">#         fig.savefig(snakemake.output.noe_plot)</span>
<span class="c1"># else:</span>
<span class="c1">#     print(&quot;cMD - no reweighted NOEs performed.&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load GaMD</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># trajectory reference:</span>
<span class="c1"># t_x: production trajectory of method x</span>
<span class="c1"># t_x_full: full trajectory of method x (equilibration &amp; production)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># t_g = md.load(snakemake.input.ga_traj, top=snakemake.input.top)</span>
<span class="c1"># print(t_g)</span>
<span class="c1"># # Remove solvent from trajectory</span>
<span class="c1"># t_g = t_g.restrict_atoms(t_g.topology.select(&#39;protein&#39;))</span>
<span class="c1"># t_g</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># t_g_full = t_g</span>
<span class="c1"># t_g = t_g[-50000:]</span>
<span class="c1"># t_g</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if has_cis_trans:</span>
<span class="c1">#     # split trajectory into 2 by defined feature</span>
    
<span class="c1">#     t_g_cis</span>
<span class="c1">#     t_g_trans</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load aMD</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># t_a = md.load(snakemake.input.a_traj, top=snakemake.input.top)</span>
<span class="c1"># print(t_a)</span>
<span class="c1"># # Remove solvent from trajectory</span>
<span class="c1"># t_a = t_a.restrict_atoms(t_a.topology.select(&#39;protein&#39;))</span>
<span class="c1"># t_a</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># t_c = md.load(snakemake.input.c_traj, top=snakemake.input.top)</span>
<span class="c1"># print(t_c)</span>
<span class="c1"># # Remove solvent from trajectory</span>
<span class="c1"># t_c = t_c.restrict_atoms(t_c.topology.select(&#39;protein&#39;))</span>
<span class="c1"># t_c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># t_g.superpose(t_g, 0)</span>
<span class="c1"># t_a.superpose(t_a, 0)</span>
<span class="c1"># t_c.superpose(t_c, 0)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if multiple:</span>
<span class="c1">#     ca_c = t_g.top.select(f&quot;resid 0 and name CA C&quot;)</span>
<span class="c1">#     n_ca_next = t_g.top.select(f&quot;resid 1 and name N CA&quot;)</span>

<span class="c1">#     omega = np.append(ca_c, n_ca_next)</span>
<span class="c1">#     t_omega_rad = md.compute_dihedrals(t_a, [omega])</span>
<span class="c1">#     t_omega_deg = np.abs(np.degrees(t_omega_rad))</span>
<span class="c1">#     plt.plot(t_omega_deg)</span>
<span class="c1">#     plt.hlines(90, 0, 50000, color=&#39;red&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if multiple:</span>
<span class="c1">#     cis = np.where(t_omega_deg &lt;= 90)[0]</span>
<span class="c1">#     trans = np.where(t_omega_deg &gt; 90)[0]</span>

<span class="c1">#     t_a[trans]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># omega = getOmega(t_c)</span>
<span class="c1"># omega_deg = np.abs(np.degrees(omega))</span>
<span class="c1"># plt.plot(omega_deg)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Principle Component Analysis (PCA)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dihedral variable reference:</span>
<span class="c1"># x_dihe: (reduced) dihedral angles of method x (via PCA)</span>
<span class="c1"># x_dihe_all: full dihedral angles of method x</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># g_dihe_all = getDih(t_g)</span>
<span class="c1"># a_dihe_all = getDih(t_a)</span>
<span class="c1"># c_dihe_all = getDih(t_c)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pca4 = PCA(n_components=2)</span>
<span class="c1"># g_dihe = pca4.fit_transform(g_dihe_all)</span>
<span class="c1"># g_dihe.shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now apply the same transformation to a_dihe, c_dihe</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a_dihe = pca4.transform(a_dihe_all)</span>
<span class="c1"># c_dihe = pca4.transform(c_dihe_all)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.scatter(g_dihe[:,0], g_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=1)</span>
<span class="c1"># plt.scatter(c_dihe[:,0], c_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=0.02)</span>
<span class="c1"># plt.scatter(a_dihe[:,0], a_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=0.02)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How much of the variance is explained by the 2 components?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print(f&quot;The two components explain {sum(pca4.explained_variance_ratio_):.2%} of the variance&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># g_weights = src.reweight(g_dihe, snakemake.input.ga_weights, &#39;amdweight_MC&#39;)</span>
<span class="c1"># a_weights = src.reweight(a_dihe, snakemake.input.a_weights, &#39;amdweight_MC&#39;)</span>
<span class="c1"># c_weights = src.reweight(c_dihe, None, &#39;noweight&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Plot re-weighted PCA plots</span>
<span class="c1"># fig, axs = plt.subplots(1,4, sharex=&#39;all&#39;, sharey=&#39;all&#39;)</span>
<span class="c1"># fig.set_size_inches(16,4)</span>

<span class="c1"># # for ax in axs:</span>
<span class="c1"># #     ax.set</span>

<span class="c1"># axs[0].scatter(g_dihe[:,0], g_dihe[:,1], c=g_weights, marker=&#39;.&#39;, cmap=&#39;Spectral_r&#39;, s=0.5)</span>
<span class="c1"># axs[0].set_title(&#39;GaMD&#39;)</span>

<span class="c1"># axs[1].scatter(a_dihe[:,0], a_dihe[:,1], c=a_weights, marker=&#39;.&#39;, cmap=&#39;Spectral_r&#39;, s=0.5)</span>
<span class="c1"># axs[1].set_title(&#39;aMD&#39;)</span>

<span class="c1"># axs[2].scatter(c_dihe[:,0], c_dihe[:,1], c=c_weights, marker=&#39;.&#39;, cmap=&#39;Spectral_r&#39;, s=0.5)</span>
<span class="c1"># axs[2].set_title(&#39;cMD&#39;)</span>

<span class="c1"># axs[3].scatter(g_dihe[:,0], g_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=1, label=&#39;GaMD&#39;)</span>
<span class="c1"># axs[3].scatter(a_dihe[:,0], a_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=0.1, label=&#39;aMD&#39;)</span>
<span class="c1"># axs[3].scatter(c_dihe[:,0], c_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=0.1, label=&#39;cMD&#39;)</span>
<span class="c1"># lgnd = axs[3].legend()</span>
<span class="c1"># for handle in lgnd.legendHandles:</span>
<span class="c1">#     handle.set_sizes([30.0])</span>
<span class="c1">#     handle.set_alpha(1)</span>

<span class="c1"># axs[3].set_title(&#39;Overlay&#39;)</span>
    
<span class="c1"># fig.savefig(snakemake.output.pca_dihe)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Load cluster data</span>
<span class="c1"># clus_g = md.load(snakemake.input.ga_clus)</span>
<span class="c1"># clus_a = md.load(snakemake.input.a_clus)</span>
<span class="c1"># clus_c = md.load(snakemake.input.c_clus)</span>
<span class="c1"># clusters = [clus_g, clus_a, clus_c]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Transform clusters in pca</span>
<span class="c1"># clusters_dih = []</span>
<span class="c1"># [clusters_dih.append(getDih(clus)) for clus in clusters]</span>
<span class="c1"># cluster_pca = []</span>
<span class="c1"># [cluster_pca.append(pca4.transform(clus)) for clus in clusters_dih]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Plot Clusters</span>
<span class="c1"># fig, ax = plt.subplots()</span>

<span class="c1"># methods = [&quot;GaMD&quot;, &quot;aMD&quot;, &quot;cMD&quot;]</span>
<span class="c1"># ax.scatter(g_dihe[:,0], g_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=0.1, c=&#39;grey&#39;)</span>
<span class="c1"># ax.scatter(a_dihe[:,0], a_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=0.1, c=&#39;grey&#39;)</span>
<span class="c1"># ax.scatter(c_dihe[:,0], c_dihe[:,1], marker=&#39;.&#39;, s=0.5, alpha=0.1, c=&#39;grey&#39;)</span>


<span class="c1"># # Plot clusters</span>
<span class="c1"># for clus, method in zip(cluster_pca, methods):</span>
<span class="c1">#     ax.scatter(clus[:,0], clus[:,1], marker=&#39;^&#39;, label=method)</span>
<span class="c1">#     for i, txt in enumerate(np.arange(len(clus[:,0]))):</span>
<span class="c1">#         ax.annotate(txt, (clus[i,0], clus[i,1], ))</span>
<span class="c1"># ax.legend()</span>
<span class="c1"># ax.set_title(&quot;Different clusters on dPCA plot&quot;)</span>
<span class="c1"># fig.savefig(snakemake.output.cluster_pca)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print(&quot;Backbone RMSD between clusters. Array indices correspond to the cluster number in plot above.&quot;)</span>
<span class="c1"># from itertools import combinations_with_replacement</span>
<span class="c1"># cluster_pairs = list(combinations_with_replacement(clusters, 2))</span>
<span class="c1"># method_pairs = list(combinations_with_replacement(methods, 2))</span>
<span class="c1"># for v, w in zip(cluster_pairs, method_pairs):</span>
<span class="c1">#     i, j = v</span>
<span class="c1">#     i_n, j_n = w</span>
<span class="c1">#     print(f&quot;RMSD between {i_n} - {j_n}&quot;)</span>
<span class="c1">#     rmsd = np.zeros((i.n_frames, j.n_frames))</span>
<span class="c1">#     for a in range(i.n_frames):</span>
<span class="c1">#         for b in range(j.n_frames):</span>
<span class="c1">#             rmsd[a,b] = md.rmsd(i[a], j[b], atom_indices = i.top.select(&#39;backbone&#39;)) * 10</span>
<span class="c1">#     print(rmsd)</span>
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "d-cru/test_report",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./22"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="ed6dd3148ef9b069_GaMD_interactive.html" title="previous page"><span class="section-number">1.2. </span>Interactive exploration</a>
    <a class='right-next' id="next-link" href="../there_test.html" title="next page"><span class="section-number">2. </span>TEST</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Daniel Crusius<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>